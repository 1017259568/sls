# 设置告警 {#task_fdb_hfm_2fb .task}

在查询页面将快速查询另存为告警，日志服务会定时执行检查，并在满足告警条件时发送告警信息。

-   已采集到日志数据。
-   已[开启并配置索引](intl.zh-CN/用户指南/索引与查询/开启并配置索引.md)。

1.  登录[日志服务控制台](https://sls.console.aliyun.com)，单击Project名称。 
2.   在**Logstore列表**页面，单击**查询分析**列下的 **查询**。 
3.   在搜索框中输入查询语句。 
4.   设置查询的时间范围，并单击**搜索**。 
5.  在页面右上角单击**另存为告警**。 

    ![](images/12433_zh-CN_source.png)

6.  设置告警规则并单击 **确定**。 

    |规则|说明|
    |:-|:-|
    |**告警规则名称**|告警规则的名称。名称长度为3~63个字符。|
    |**告警规则属性**|
    |**快速查询名称**|设置告警中使用的快速查询名称，可以设置为：    -   **使用当前查询**，表示使用当前的查询语句作为快速查询。
    -   已存在的其他快速查询。创建快速查询请参考[快速查询](intl.zh-CN/用户指南/索引与查询/快速查询.md)。
|
    |**数据查询时间（分钟）**|服务端每次执行告警检查读取的数据时间范围。例如，设置为1时表示即对最近1分钟到执行检查的当前时间进行查询。数据查询时间单位为分钟，取值范围为1~60。

**说明：** 目前服务端每次告警规则检查只会采样处理时间区间开始的前 10 条数据。

|
    |**检查间隔（分钟）**|服务端每次执行告警检查的时间间隔。检查间隔单位为分钟，取值范围为1~1440。

|
    |**触发次数**|告警检查连续触发的次数，达到指定的触发次数后立即发送告警通知。取值范围为1~10，000。

例如，**检查间隔（分钟）**设置为 1，**触发次数**设置为2，表示每隔1分钟执行一次检查，连续 2 次检查均满足告警条件即发送告警，连续两次告警通知之间最小间隔为 2 分钟。

|
    |**检查条件**|
    |**字段名称**|日志内容中用于告警的 Key 名称。|
    |**比较符**|检查条件中的比较符，支持数值类和字符类比较符。比较符说明请参考[比较符](#)。|
    |**检查阈值**|检查条件中的比较值，与**比较符**组合判断快速查询的结果是否符合告警条件。|
    |**告警动作**|
    |**通知类型**|发送告警通知的方式。当您设置的告警规则被触发后，日志服务将通过您预先设定的通知方式，为您发送告警提醒。通知类型包括：

    -   **通知中心**（推荐）：向阿里云[通知中心](intl.zh-CN/用户指南/告警与通知/通知方式.md#section_hrf_3zz_zdb)设置的联系人发送短信或邮件。
    -   **WebHook-钉钉机器人**：在钉钉群中以[钉钉机器人](intl.zh-CN/用户指南/告警与通知/通知方式.md#section_l15_111_12b)消息的方式发送通知。
    -   **WebHook-自定义**：以Post方式发送通知到[自定义WebHook链接](intl.zh-CN/用户指南/告警与通知/通知方式.md#section_flh_db1_12b)。
|
    |**WebHook地址**|WebHook的URL地址。**通知类型**为**WebHook-钉钉机器人**和**WebHook-自定义**时配置。|
    |**通知内容**|告警通知的内容。最多支持500个字符。|

    |操作|描述|示例|
    |:-|:-|:-|
    |\>|该列是否大于数值|$count \> 0|
    |<|该列是否小于数值|$count<200|
    |\>=|大于等于某个数值|$count\>=0|
    |<=|小于等于某个数值|$count<=0|
    |like|匹配子串|$project like “admin”|
    |regex|正则匹配字符串|$project regex match “^/S+$”|

    ![](images/5776_zh-CN.png "报警规则")


创建完成告警规则后，您可以查看具体的告警记录。

1.  在**Logstore列表**页面，选择左侧导航栏中的**Search/Analytics - 查询分析** \> **告警配置**。
2.  选择要查看的告警规则并单击右侧的**查看告警记录**即可查看具体告警记录。

**告警状态** ：

-   **成功**：规则被成功执行，在告警触发详情显示触发标准。
-   **失败**：查询、告警规则、或通知阶段失败，可以查看**告警触发详情** 获得详细信息。
    -   查询失败：一般为语法不正确。
    -   查询调用失败：请提交工单。
    -   规则调用失败：请检查规则参数和返回数据格式是否一致。

