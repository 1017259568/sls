# 选择网络 {#concept_st2_rwn_y2b .concept}

采集日志数据到日志服务时，日志数据可以通过**阿里云内网**、**公网**和**全球加速**网络传输。

## 网络类型 {#section_ohn_j55_y2b .section}

-   **公网**：使用公网传输日志数据，不仅会受到网络带宽的限制，还可能会因网络抖动、延迟、丢包等影响数据采集的速度和稳定性。
-   **阿里云内网**：阿里云内网为千兆共享网络，日志数据通过阿里云内网传输比公网传输更快速、稳定。内网包括**VPC**环境和**经典网络**环境。
-   **全球加速**：利用阿里云CDN边缘节点进行日志采集加速，相对公网采集在网络延迟、稳定性上具有很大优势。

## 如何选择网络 {#section_bnz_cx4_y2b .section}

-   **内网**：

    您的日志数据是否通过阿里云内网传输，取决于您的服务器类型以及服务器和日志服务Project是否在同一地域。仅有以下两种情况可以使用阿里云内网传输：

    -   **本账号下的ECS和日志服务Project在同一地域**。
    -   **其他账号的ECS和本账号的日志服务Project在同一地域**。
    因此，建议您在ECS的相同地域下创建日志服务Project，并将日志采集到同地域的日志服务Project中。ECS上的日志数据自动通过**阿里云内网**写入日志服务，不消耗公网带宽。

    **说明：** 在服务器上安装Logtail时，选择的地域必须和Project所在地域一致，否则无法正常采集日志数据。

-   **全球加速**：

    如果您的服务器分布在海外各地的自建机房、或者来自海外云厂商，使用公网传输数据可能会出现网络延迟高、传输不稳定等问题，可以通过[全球加速](intl.zh-CN/用户指南/数据采集/采集加速/简介.md)传输数据。[全球加速](intl.zh-CN/用户指南/数据采集/采集加速/简介.md)利用阿里云CDN边缘节点进行日志采集加速，相对公网采集在网络延迟、稳定性上具有很大优势。

-   **公网**：

    在以下两种情况时，您可以选择网络类型为公网：

    -   服务器为ECS，但和日志服务Project位于不同地域。
    -   服务器为其他云厂商服务器、自建IDC。

|服务器类型|是否与Project同一地域|是否需要配置AliUid|网络类型|
|:----|:-------------|:-----------|:---|
|本账号下的ECS|同一地域|不需要|阿里云内网|
|不同地域|不需要|公网或全球加速|
|其他账号下的ECS|同一地域|需要|阿里云内网|
|不同地域|需要|公网或全球加速|
|其他云厂商服务器、自建IDC|-|需要|公网或全球加速|

**说明：** 日志服务无法获取非本账号下ECS、其他服务器的属主信息，请在安装Logtail后手动配置用户标识（AliUid），否则安装Logtail的服务器会心跳异常、无法收集日志。详细步骤请参见 [为非本账号ECS、自建IDC配置AliUid](intl.zh-CN/用户指南/Logtail采集/机器组/为非本账号ECS、自建IDC配置AliUid.md)。

## 网络选择示例 {#section_edy_bxx_y2b .section}

以下是各种常见场景的网络选择示例。

|场景类型|日志服务Project地域|服务器类型|ECS地域|安装Logtail时选择的地域|网络类型|是否需要配置AliUid|
|:---|:------------|:----|:----|:--------------|:---|:-----------|
|相同地域场景|华东1（杭州）|本账号ECS|华东1（杭州）|华东1（杭州）|内网|不需要|
|不同地域场景|华东2（上海）|本账号ECS|华北1（北京）|华北1（北京）|公网|不需要|
|其他账号场景|华东2（上海）|其他账号ECS|华北1（北京）|华北1（北京）|公网|需要|
|本地机房场景|华东5（深圳）|自建IDC|-|华东5（深圳）|公网|需要|
|全球加速场景|香港|自建IDC|-|香港|全球加速|需要|

**说明：** 全球加速场景中，日志服务Project创建在香港地域，服务器为全球各地的自建机房，数据采集的速度和可靠性尤为重要，所以建议您在类似场景下安装Logtail时选择香港地域的全球加速网络类型。日志数据通过全球加速传输，比公网传输的网络稳定性更高、性能更好。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/18799/153715511512057_zh-CN.png)

## 经典网络切换VPC后的配置更新 {#section_efx_swn_y2b .section}

安装Logtail后，如果您的ECS网络类型由经典网络切换为VPC，请参考以下步骤更新配置。

1.  以管理员身份重启Logtail。
    -   **Linux**：

        ```
        sudo /etc/init.d/ilogtaild stop
        sudo /etc/init.d/ilogtaild start
        ```

    -   **Windows**：

        打开**控制面板**中的**管理工具**，打开**服务**，找到LogtailWorker并右键单击**重新启动**。

2.  更新机器组配置。
    -   **自定义标识**

        若机器组中配置了自定义标识，则无需手动更新机器组配置，可以直接正常使用VPC网络。

    -   **IP地址**

        若机器组中配置了ECS云服务器IP地址，则需将机器组内的IP更换为重启Logtail后获取的IP地址，即app\_info.json中的ip字段。

        app\_info.json文件地址：

        -   Linux：/usr/local/ilogtail/app\_info.json
        -   Windows x64：C:\\Program Files \(x86\)\\Alibaba\\Logtail\\app\_info.json
        -   Windows x32：C:\\Program Files\\Alibaba\\Logtail\\app\_info.json

